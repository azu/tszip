"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("fs"),r=require("@babel/helper-module-imports/lib/index.js"),t=require("fs-extra/lib/index.js"),o=require("path");function n(e){return e&&"object"==typeof e&&"default"in e?e:{"default":e}}require("camelcase/index.js");var a=n(e),s=n(t),i=n(o);function p(e){switch(e.type){case"StringLiteral":case"Literal":return e.value;case"BinaryExpression":if("+"!==e.operator)throw new Error("Unsupported binary operator "+e.operator);return p(e.left)+p(e.right);default:throw new Error("Unsupported type "+e.type)}}const c=s.default.realpathSync(process.cwd()),l=function(e){return i.default.resolve(c,e)},u={appPackageJson:l("package.json"),tsconfigJson:l("tsconfig.json"),testsSetup:l("test/setupTests.ts"),appRoot:l("."),appSrc:l("src"),appErrorsJson:l("errors/codes.json"),appErrors:l("errors"),appDist:l("dist"),appConfig:l("export-ts.config.js"),jestConfig:l("jest.config.js"),progressEstimatorCache:l("node_modules/.cache/.progress-estimator")};exports.default=function(e){const t=e.types,o=t.identifier("__DEV__");return{visitor:{CallExpression(e,n){const s=e.node,i=n.opts.noMinify;if(e.get("callee").isIdentifier({name:"invariant"})){const n=s.arguments[0],c=p(s.arguments[1]),l=Array.from(s.arguments.slice(2)),f=c.split("%s").map((e=>t.templateElement({raw:e,cooked:String.raw({raw:e})}))),d=r.addDefault(e,u.appRoot+"/errors/ErrorDev.js",{nameHint:"InvariantError"}),m=t.throwStatement(t.callExpression(d,[t.templateLiteral(f,l)]));if(i)return void e.replaceWith(t.ifStatement(t.unaryExpression("!",n),t.blockStatement([m])));let E=function(e){const r={},t=Object.keys(e);for(const o of t)r[e[o]]=o;return r}(JSON.parse(a.default.readFileSync(u.appErrorsJson,"utf-8")))[c];if(void 0===E)return e.replaceWith(t.ifStatement(t.unaryExpression("!",n),t.blockStatement([m]))),void e.addComment("leading","FIXME (minify-errors-in-prod): Unminified error message in production build!");E=parseInt(E,10);const g=r.addDefault(e,u.appRoot+"/errors/ErrorProd.js",{nameHint:"InvariantErrorProd"}),S=t.throwStatement(t.callExpression(g,[t.numericLiteral(E),...l]));e.replaceWith(t.ifStatement(t.unaryExpression("!",n),t.blockStatement([t.ifStatement(o,t.blockStatement([m]),t.blockStatement([S]))])))}}}}};
//# sourceMappingURL=transformErrorMessages.cjs.map
