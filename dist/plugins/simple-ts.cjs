"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("child_process"),t=require("typescript/lib/typescript.js"),r=require("fs-extra/lib/index.js"),s=require("fs-extra/lib/index.js"),o=require("path");require("camelcase/index.js");var n=require("progress-estimator/src/index.js");function i(e){return e&&"object"==typeof e&&"default"in e?e:{"default":e}}function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,t}var c=a(t),u=i(r),l=i(s),p=i(o),f=i(n);const d=l.default.realpathSync(process.cwd()),g=function(e){return p.default.resolve(d,e)},h={appPackageJson:g("package.json"),tsconfigJson:g("tsconfig.json"),testsSetup:g("test/setupTests.ts"),appRoot:g("."),appSrc:g("src"),appErrorsJson:g("errors/codes.json"),appErrors:g("errors"),appDist:g("dist"),appConfig:g("export-ts.config.js"),jestConfig:g("jest.config.js"),progressEstimatorCache:g("node_modules/.cache/.progress-estimator")};function m(){const e=c.findConfigFile(".",c.sys.fileExists);if(!e)throw Error("tsconfig not found");const t=c.sys.readFile(e)??"",r=c.parseConfigFileTextToJson(e,t).config;return c.parseJsonConfigFileContent(r,c.sys,process.cwd(),void 0,e)}async function j({transpileOnly:t=!1,watch:r=!1}={}){const s=`--rootDir src/ --outDir dist/ --noEmit false --strict ${t}`.split(" ");console.log(`> Command: tsc ${s.join(" ")}`);const o=await async function(){return await u.default.ensureDir(h.progressEstimatorCache),f.default({storagePath:h.progressEstimatorCache})}();await o(new Promise((t=>{e.spawn("tsc",s,{stdio:"inherit"}).on("exit",(e=>{if(0!==e)throw Error("TypeScript build failed");t(void 0)}))})),"TS âž¡ JS: Compiling with TSC"),r&&e.spawn("tsc",[...s,"--watch","--preserveWatchOutput"],{stdio:"inherit"})}exports.default=function(){return{name:"simple-ts",buildStart:async()=>await j()}},exports.loadConfig=m,exports.resolveId=function(e,t=""){const r=m();if(!t)return null;const s=c.resolveModuleName(e,t,r.options,c.sys);return s.resolvedModule&&".d.ts"!==s.resolvedModule.extension?s.resolvedModule.resolvedFileName:null},exports.runTsc=j;
//# sourceMappingURL=simple-ts.cjs.map
