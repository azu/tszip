{"version":3,"file":"deprecated.cjs","sources":["../src/utils.ts","../src/constants.ts","../src/deprecated.ts"],"sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\nimport camelCase from 'camelcase';\n\nimport { PackageJson } from './types';\n\n// Remove the package name scope if it exists\nexport const removeScope = (name: string) => name.replace(/^@.*\\//, '');\n\n// UMD-safe package name\nexport const safeVariableName = (name: string) =>\n  camelCase(\n    removeScope(name)\n      .toLowerCase()\n      .replace(/((^[^a-zA-Z]+)|[^\\w.-])|([^a-zA-Z0-9]+$)/g, '')\n  );\n\nexport const safePackageName = (name: string) =>\n  name\n    .toLowerCase()\n    .replace(/(^@.*\\/)|((^[^a-zA-Z]+)|[^\\w.-])|([^a-zA-Z0-9]+$)/g, '');\n\nexport const external = (id: string) =>\n  !id.startsWith('.') && !path.isAbsolute(id);\n\n// Make sure any symlinks in the project folder are resolved:\n// https://github.com/facebookincubator/create-react-app/issues/637\nexport const appDirectory = fs.realpathSync(process.cwd());\nexport const resolveApp = function (relativePath: string) {\n  return path.resolve(appDirectory, relativePath);\n};\n\n// Taken from Create React App, react-dev-utils/clearConsole\n// @see https://github.com/facebook/create-react-app/blob/master/packages/react-dev-utils/clearConsole.js\nexport function clearConsole() {\n  process.stdout.write(\n    process.platform === 'win32' ? '\\x1B[2J\\x1B[0f' : '\\x1B[2J\\x1B[3J\\x1B[H'\n  );\n}\n\nexport function getReactVersion({\n  dependencies,\n  devDependencies,\n}: PackageJson) {\n  return (\n    (dependencies && dependencies.react) ||\n    (devDependencies && devDependencies.react)\n  );\n}\n\nexport function getNodeEngineRequirement({ engines }: PackageJson) {\n  return engines && engines.node;\n}\n","import { resolveApp } from './utils';\n\nexport const paths = {\n  appPackageJson: resolveApp('package.json'),\n  tsconfigJson: resolveApp('tsconfig.json'),\n  testsSetup: resolveApp('test/setupTests.ts'),\n  appRoot: resolveApp('.'),\n  appSrc: resolveApp('src'),\n  appErrorsJson: resolveApp('errors/codes.json'),\n  appErrors: resolveApp('errors'),\n  appDist: resolveApp('dist'),\n  appConfig: resolveApp('export-ts.config.js'),\n  jestConfig: resolveApp('jest.config.js'),\n  progressEstimatorCache: resolveApp('node_modules/.cache/.progress-estimator'),\n};\n","import * as fs from 'fs-extra';\n\nimport { paths } from './constants';\n\n/*\n  This was originally needed because the default\n  tsconfig.compilerOptions.rootDir was set to './' instead of './src'.\n  Now that it's set to './src', this is now deprecated.\n  To ensure a stable upgrade path for users, leave the warning in for\n  6 months - 1 year, then change it to an error in a breaking bump and leave\n  that in for some time too.\n*/\nexport async function moveTypes() {\n  const appDistSrc = paths.appDist + '/src';\n\n  const pathExists = await fs.pathExists(appDistSrc);\n  if (!pathExists) return;\n\n  // see note above about deprecation window\n  console.warn(\n    '[export-ts]: Your rootDir is currently set to \"./\". Please change your ' +\n      'rootDir to \"./src\".\\n' +\n      'export-ts has deprecated setting tsconfig.compilerOptions.rootDir to ' +\n      '\"./\" as it caused buggy output for declarationMaps and more.\\n' +\n      'You may also need to change your include to remove \"test\", which also ' +\n      'caused declarations to be unnecessarily created for test files.'\n  );\n\n  // Move the type declarations to the base of the ./dist folder\n  await fs.copy(appDistSrc, paths.appDist, {\n    overwrite: true,\n  });\n  await fs.remove(appDistSrc);\n}\n"],"names":["relativePath","paths","appPackageJson","resolveApp","tsconfigJson","testsSetup","appRoot","appSrc","appErrorsJson","appErrors","appDist","appConfig","jestConfig","progressEstimatorCache","async","appDistSrc","fs","pathExists","console","warn","copy","overwrite","remove"],"mappings":"6lBA6BoCA,kCC3BvBC,EAAQ,CACnBC,eAAgBC,EAAW,gBAC3BC,aAAcD,EAAW,iBACzBE,WAAYF,EAAW,sBACvBG,QAASH,EAAW,KACpBI,OAAQJ,EAAW,OACnBK,cAAeL,EAAW,qBAC1BM,UAAWN,EAAW,UACtBO,QAASP,EAAW,QACpBQ,UAAWR,EAAW,uBACtBS,WAAYT,EAAW,kBACvBU,uBAAwBV,EAAW,8DCD9BW,iBACL,MAAMC,EAAad,EAAMS,QAAU,aAEVM,EAAGC,WAAWF,KAIvCG,QAAQC,KACN,8WASIH,EAAGI,KAAKL,EAAYd,EAAMS,QAAS,CACvCW,WAAW,UAEPL,EAAGM,OAAOP"}